<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=devicewidth; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;"/>
<title>微盘</title>
<link rel="apple-touch-icon" href="images/icon.png" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<link rel="stylesheet" href="iui/iui.css" type="text/css" />
<link rel="stylesheet" href="iui/t/default/default-theme.css"  type="text/css"/>
<script type="text/javascript" charset="utf-8" src="phonegap-1.0.0.js"></script>
<script type="text/javascript" src="js/2.0.0-crypto-sha256.js" charset="utf-8"></script>
<script type="text/javascript" src="js/2.0.0-hmac-min.js" charset="utf-8"></script>
<script type="text/javascript" src="js/dojo.js"  charset="utf-8"></script>
<script type="text/javascript" src="js/vdisk.js" charset="utf-8"></script>
</head>
<body>
<div class="toolbar">
    <h1 id="pageTitle">微盘</h1>
</div>
<div id="login" title="登录" class="panel" selected="true">
	<fieldset class="login">
		<div class="row">
			<div class="row_lab">
				<label>账号</label>
			</div>
			<div class="row_inp">
				<input type="text" name="account" class="inp" tabindex="1" id="account"/>
			</div>
		</div>
		<div class="row">
			<div class="row_lab">
				<label>密码</label>
			</div>
			<div class="row_inp">
				<input type="password" name="password" id="password" tabindex="2"/>
			</div>
		</div>
		<div class="row">
			<div class="row_lab">
				<label>微博账号</label>
			</div>
			<div class="row_inp">
				<input type="checkbox" name="" value="" checked class="row_che" tabindex="-1" id="appType"/>
			</div>
		</div>
	</fieldset>
	<a class="whiteButton" type="submit" tabindex="3"  id="loginSubmit" onclick="login()">登录</a>
</div>

<script type="text/javascript" charset="utf-8">

// Wait for PhoneGap to load
//
document.addEventListener("deviceready", onDeviceReady, false);

//dom ready
window.onload = function(){
	domready();
};

function domready(){
	if (window.localStorage.getItem("token")) window.location.href = 'list.html'; 
}

function login(){
	var $account = dojo.byId('account').value;
	var $password = dojo.byId('password').value;
	var $appType = dojo.attr(dojo.byId('appType'), "checked");  
	get_token($account,$password,$appType); 
}

	// PhoneGap is ready
	//
	function onDeviceReady() {

		//test camera
		pictureSource=navigator.camera.PictureSourceType;
		destinationType=navigator.camera.DestinationType;

	}
	//test camera


    // Called when a photo is successfully retrieved
    //
    function onPhotoDataSuccess(imageData) {
      // Uncomment to view the base64 encoded image data
      // console.log(imageData);

      // Get image handle
      //
      var smallImage = document.getElementById('smallImage');

      // Unhide image elements
      //
      smallImage.style.display = 'block';

      // Show the captured photo
      // The inline CSS rules are used to resize the image
      //
      smallImage.src = "data:image/jpeg;base64," + imageData;
    }

    // Called when a photo is successfully retrieved
    //
    function onPhotoURISuccess(imageURI) {
      // Uncomment to view the image file URI 
      // console.log(imageURI);

      // Get image handle
      //
      var largeImage = document.getElementById('largeImage');

      // Unhide image elements
      //
      largeImage.style.display = 'block';

      // Show the captured photo
      // The inline CSS rules are used to resize the image
      //
      largeImage.src = imageURI;
    }

    // A button will call this function
    //
    function capturePhoto() {
      // Take picture using device camera and retrieve image as base64-encoded string
      navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 50 });
    }

    // A button will call this function
    //
    function capturePhotoEdit() {
      // Take picture using device camera, allow edit, and retrieve image as base64-encoded string  
      navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 20, allowEdit: true }); 
    }

    // A button will call this function
    //
    function getPhoto(source) {
      // Retrieve image file location from specified source
      navigator.camera.getPicture(onPhotoURISuccess, onFail, { quality: 50, 
        destinationType: destinationType.FILE_URI,
        sourceType: source });
    }

    // Called if something bad happens.
    // 
    function onFail(message) {
      alert('Failed because: ' + message);
    }




</script>


    <button onclick="capturePhoto();">Capture Photo</button> <br>
    <button onclick="capturePhotoEdit();">Capture Editable Photo</button> <br>
    <button onclick="getPhoto(pictureSource.PHOTOLIBRARY);">From Photo Library</button><br>
    <button onclick="getPhoto(pictureSource.SAVEDPHOTOALBUM);">From Photo Album</button><br>
    <img style="display:none;width:60px;height:60px;" id="smallImage" src="" />
    <img style="display:none;" id="largeImage" src="" />




</body>
</html>